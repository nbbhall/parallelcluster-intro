# High Performance Computing (HPC) - Intro

HPC is the ability to perform **parallel** data processing to **improve computing performance** and **perform complex calculations** at high speeds

It's popular applications include AI/ML, trend analysis, test simulation, etc

## HPC typically has
- A cluster of co-located multi-node compute (CPU, GPU, RAM)
- High network bandwidth
- Shared storage
- job orchestration engine (scheduler)

<p>&nbsp;</p>

## HPC on Cloud v/s HPC on-premise

- on-demand, virtually infinite compute capacity
- Elasticity – scale up and down as required; pay only for what you use
- Choice of infrastructure (Spot, On-demand, Graviton, C5n)

<p>&nbsp;</p>

## Why ParallelCluster?

- Provides ease of HPC cluster provisioning and management (through text based configuration files)
- Provides automatic compute resource scaling (on-demand or spot)
- Automatic shared storage scaling (using EFS or FSx)
- Ease of migration from on-premise (slurm job scheduler)
- Ease of integration with other AWS services
- Open source

<p>&nbsp;</p>

## Architecture

- client (pcluster)
- head node
- compute node
- job scheduler
- EFS / FSx for Lusture (shared FS)

![](pc-arch.png)

<p>&nbsp;</p>

## User Workflow 

![](workflow.png)

<p>&nbsp;</p>

## Main Components

- job scheduler (slurm or awsbatch)
- head node
- compute nodes
- EFA
- EFS / FSx for Lusture (shared file system between master and compute nodes)

<p>&nbsp;</p>

## Other Components - clustermgtd (Slurm only)

- Syncs scheduler with EC2 status
- Static capacity management (ensure required number of EC2 are up)
- Unhealthy Amazon EC2 instances management
- Unhealthy Scheduler nodes management

<p>&nbsp;</p>

## Other Components - computemgtd (Slurm only)

- compute management daemon running on each compute node
- Syncs with head node every 5 mins
- Shuts down if it cannot reach head node

<p>&nbsp;</p>

## Other Components – nodewatcher (both slurm and awabatch)

- Runs on each node in the compute fleet
- monitors node and scales down if 
    - no job on instance for more than 10 mins (scaledown_idletime)
AND
    - no pending jobs 

![](nodewatcher.png)

<p>&nbsp;</p>

## Network Configuration

### VPC requirements
- DNS Resolution = yes
- DNS Hostnames = yes

<p>&nbsp;</p>

### Supported configurations
- One subnet for both head and compute nodes
- Two subnets, with the head node in one public subnet, and compute nodes in a private subnet (with NAT gateway)

[supported network configuration](https://docs.aws.amazon.com/parallelcluster/latest/ug/network-configuration-v3.html)

<p>&nbsp;</p>

## Job Schedulers

[Slurm](https://slurm.schedmd.com)

[awsbatch](https://aws.amazon.com/batch)

<p>&nbsp;</p>

## ParallelCluster Install - requirements

- Linux/MacOS
- Python
- AWS CLI
- pip
- virtualenv (optional)

<p>&nbsp;</p>

## ParallelCluster Install - Lab

[Supported regions](https://docs.aws.amazon.com/parallelcluster/latest/ug/supported-regions.html)

<p>&nbsp;</p>

### High level steps
- Create a workstation (CloudFormation)
- Setup pre-req on workstation
- Install pcluster

<p>&nbsp;</p>

## Out of scope
- code troubleshooting
- code support
- only infrastructure is supported


<p>&nbsp;</p>